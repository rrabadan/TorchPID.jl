<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Photon · TorchPID.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link rel="canonical" href="https://rrabadan.github.io/TorchPID.jl/api/photon/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/custom.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">TorchPID.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../torch/">TORCH Detector</a></li><li><a class="tocitem" href="../../guide/">Guide</a></li><li><span class="tocitem">API</span><ul><li><a class="tocitem" href="../api/">Overview</a></li><li><a class="tocitem" href="../physics_constants/">Physics Constants</a></li><li><a class="tocitem" href="../hit_models/">Hit Models</a></li><li class="is-active"><a class="tocitem" href>Photon</a></li><li><a class="tocitem" href="../photonmapper/">Photon Mapper</a></li><li><a class="tocitem" href="../photonspectrum/">Photon Spectrum</a></li><li><a class="tocitem" href="../pattern_matcher/">Pattern Matcher</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">API</a></li><li class="is-active"><a href>Photon</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Photon</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/rrabadan/TorchPID.jl/blob/main/docs/src/api/photon.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Photon-API"><a class="docs-heading-anchor" href="#Photon-API">Photon API</a><a id="Photon-API-1"></a><a class="docs-heading-anchor-permalink" href="#Photon-API" title="Permalink"></a></h1><p>Core definitions and utilities for photon properties and behavior.</p><h3 id="Public-API"><a class="docs-heading-anchor" href="#Public-API">Public API</a><a id="Public-API-1"></a><a class="docs-heading-anchor-permalink" href="#Public-API" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="TorchPID.Photon" href="#TorchPID.Photon"><code>TorchPID.Photon</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Photon(energy, xdir, ydir, zdir, xpos, ypos, zpos, slope,
       np, ng, lambda, emissionTime, is_x_reflected,
       is_y_reflected, is_z_reflected)</code></pre><p>Type representing a photon emitted by TORCH&#39;s radiator and propagated to the detector. Position coordinates are in millimeters (mm).</p><p><strong>Fields</strong></p><ul><li><code>energy::Float64</code>: Photon energy.</li><li><code>xdir::Float64</code>: X-component of the photon direction in the lab frame.</li><li><code>ydir::Float64</code>: Y-component of the photon direction in the lab frame.</li><li><code>zdir::Float64</code>: Z-component of the photon direction in the lab frame.</li><li><code>xpos::Float64</code>: X-coordinate of the emission point.</li><li><code>ypos::Float64</code>: Y-coordinate of the emission point.</li><li><code>zpos::Float64</code>: Z-coordinate of the emission point.</li><li><code>slope::Float64</code>: Slope of the trajectory.</li><li><code>np::Float64</code>: Phase refractive index.</li><li><code>ng::Float64</code>: Group refractive index.</li><li><code>lambda::Float64</code>: Wavelength computed as LAMBDA/energy.</li><li><code>emissionTime::Float64</code>: Time at emission.</li><li><code>is_x_reflected::Bool</code>: Flag indicating reflection status in x-direction.</li><li><code>is_y_reflected::Bool</code>: Flag indicating reflection status in y-direction.</li><li><code>is_z_reflected::Bool</code>: Flag indicating reflection status in z-direction.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TorchPID.PhotonFactory" href="#TorchPID.PhotonFactory"><code>TorchPID.PhotonFactory</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">PhotonFactory(radiator, nair, lambda)</code></pre><p>Type representing a factory for creating photons with common properties.</p><p><strong>Fields</strong></p><ul><li><code>radiator::Radiator</code>: The radiator material properties and dimensions.</li><li><code>nair::Float64</code>: The refractive index of air.</li><li><code>lambda::Float64</code>: Reference wavelength for calculations.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L45-L54">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TorchPID.create_explicit_photon-Tuple{PhotonFactory, Particle, Vararg{Float64, 5}}" href="#TorchPID.create_explicit_photon-Tuple{PhotonFactory, Particle, Vararg{Float64, 5}}"><code>TorchPID.create_explicit_photon</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">create_explicit_photon(factory, particle, beta, phic, energy, nphase, ngroup)</code></pre><p>Creates a Photon instance with a specific azimuthal angle instead of random sampling. The Cherenkov angle is calculated from beta and the phase refractive index. The emission point is determined at the default location in the radiator.</p><p><strong>Arguments</strong></p><ul><li><code>factory::PhotonFactory</code>: The factory containing radiator and refractive index properties.</li><li><code>particle::Particle</code>: The particle instance emitting the photon.</li><li><code>beta::Float64</code>: The velocity factor of the particle (v/c).</li><li><code>phic::Float64</code>: The specified azimuthal angle for the photon emission.</li><li><code>energy::Float64</code>: The photon energy in appropriate units.</li><li><code>nphase::Float64</code>: The phase refractive index for the specific photon energy.</li><li><code>ngroup::Float64</code>: The group refractive index for the specific photon energy.</li></ul><p><strong>Returns</strong></p><ul><li><code>Photon</code>: A new Photon object populated with calculated properties.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L130-L148">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TorchPID.create_explicit_photon-Tuple{PhotonFactory, Particle, Vararg{Float64, 8}}" href="#TorchPID.create_explicit_photon-Tuple{PhotonFactory, Particle, Vararg{Float64, 8}}"><code>TorchPID.create_explicit_photon</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">create_explicit_photon(factory, particle, thetac, phic, energy, nphase, ngroup, xemission, yemission, zemission)</code></pre><p>Creates a Photon instance with precisely specified Cherenkov angle, azimuthal angle, and emission point coordinates. This function provides maximum control over the photon properties for simulation purposes.</p><p><strong>Arguments</strong></p><ul><li><code>factory::PhotonFactory</code>: The factory containing radiator and refractive index properties.</li><li><code>particle::Particle</code>: The particle instance emitting the photon.</li><li><code>thetac::Float64</code>: The specified Cherenkov angle for the photon emission.</li><li><code>phic::Float64</code>: The specified azimuthal angle for the photon emission.</li><li><code>energy::Float64</code>: The photon energy in appropriate units.</li><li><code>nphase::Float64</code>: The phase refractive index for the specific photon energy.</li><li><code>ngroup::Float64</code>: The group refractive index for the specific photon energy.</li><li><code>xemission::Float64</code>: The x-coordinate of the emission point.</li><li><code>yemission::Float64</code>: The y-coordinate of the emission point.</li><li><code>zemission::Float64</code>: The z-coordinate of the emission point (depth in radiator).</li></ul><p><strong>Returns</strong></p><ul><li><code>Photon</code>: A new Photon object populated with calculated properties.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L196-L216">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TorchPID.create_random_photon-Tuple{PhotonFactory, Particle, Vararg{Float64, 4}}" href="#TorchPID.create_random_photon-Tuple{PhotonFactory, Particle, Vararg{Float64, 4}}"><code>TorchPID.create_random_photon</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">create_random_photon(factory, particle, beta, nphase, ngroup, energy)</code></pre><p>Creates a Photon instance by determining its direction, emission point, and reflection flags based on the particle&#39;s properties, photon energy, and refractive indices.  The Cherenkov angle is calculated using the particle&#39;s velocity and the phase refractive index.  A random azimuthal angle (phi) is uniformly sampled between 0 and 2π to simulate isotropic emission.  The emission point is randomly chosen along the radiator depth to reflect realistic photon production.  Reflection flags are set by comparing the photon&#39;s direction with the critical angle for total internal reflection.  Surface roughness effects are excluded from this constructor and are handled separately.</p><p><strong>Arguments</strong></p><ul><li><code>factory::PhotonFactory</code>: The factory containing radiator and refractive index properties.</li><li><code>particle::Particle</code>: The particle instance emitting the photon.</li><li><code>beta::Float64</code>: The velocity factor of the particle (v/c).</li><li><code>nphase::Float64</code>: The phase refractive index for the specific photon energy.</li><li><code>ngroup::Float64</code>: The group refractive index for the specific photon energy.</li><li><code>energy::Float64</code>: The photon energy in appropriate units.</li></ul><p><strong>Returns</strong></p><ul><li><code>Photon</code>: A new Photon object populated with calculated properties.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L60-L80">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TorchPID.in_focus_acceptance-Tuple{Photon}" href="#TorchPID.in_focus_acceptance-Tuple{Photon}"><code>TorchPID.in_focus_acceptance</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">in_focus_acceptance(photon::Photon)::Bool</code></pre><p><code>in_focus_acceptance</code> checks whether the photon is within the focus acceptance region.      Acceptance is based on the slope of the photon trajectory.      Checks against minimum and maximum slope angles defined in FOCUS constants.</p><p><strong>Arguments</strong></p><ul><li><code>photon::Photon</code>: The photon instance.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Whether the photon is within the acceptance region (true) or not (false).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L281-L295">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TorchPID.test_z_surface_roughness-Tuple{Photon, Float64, Int64}" href="#TorchPID.test_z_surface_roughness-Tuple{Photon, Float64, Int64}"><code>TorchPID.test_z_surface_roughness</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">test_z_surface_roughness(photon::Photon, roughness::Float64, nreflec::Int)::Bool</code></pre><p>Tests the photon surface roughness in the z-direction.  Surface roughness is modeled as a Gaussian effect dependent on wavelength. The probability of passing decreases with number of reflections.</p><p><strong>Arguments</strong></p><ul><li><code>photon::Photon</code>: The photon instance.</li><li><code>roughness::Float64</code>: The surface roughness parameter in appropriate units.</li><li><code>nreflec::Int</code>: The number of reflections.</li></ul><p><strong>Returns</strong></p><ul><li><code>Bool</code>: Whether the photon passes the surface roughness condition (true) or not (false).</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L260-L274">source</a></section></article><h3 id="Implementation-Details"><a class="docs-heading-anchor" href="#Implementation-Details">Implementation Details</a><a id="Implementation-Details-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation-Details" title="Permalink"></a></h3><p>The Photon constructor internally uses helper functions for:</p><ul><li>Calculating photon directions (<code>_photon_direction</code>)  </li><li>Determining emission positions (<code>_photon_emission</code>)</li></ul><p>These internal functions are not part of the public API and may change without notice.</p><article class="docstring"><header><a class="docstring-binding" id="TorchPID._photon_direction-Tuple{Particle, Float64, Float64, Float64}" href="#TorchPID._photon_direction-Tuple{Particle, Float64, Float64, Float64}"><code>TorchPID._photon_direction</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_photon_direction(p::Particle, costhetac::Float64, sinthetac::Float64, phic::Float64)</code></pre><p><code>_photon_direction</code> computes the direction of the photon emitted by the particle in the lab frame.      The photon direction is determined from the Cherenkov angle and azimuthal angle and      rotated to the lab frame using the particle&#39;s direction.</p><p><strong>Arguments</strong></p><ul><li><code>p::Particle</code>: The particle instance.</li><li><code>costhetac::Float64</code>: Cosine of the Cherenkov angle.</li><li><code>sinthetac::Float64</code>: Sine of the Cherenkov angle.</li><li><code>phic::Float64</code>: Azimuthal angle around the particle direction.</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Float64,Float64,Float64,Float64}</code>: A tuple containing (xdir, ydir, zdir, slope) of the photon direction.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L303-L319">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TorchPID._photon_emission-Tuple{PhotonFactory, Particle, Float64}" href="#TorchPID._photon_emission-Tuple{PhotonFactory, Particle, Float64}"><code>TorchPID._photon_emission</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">_photon_emission(p::Particle, zemission::Float64)::Tuple{Float64,Float64,Float64}
_photon_emission(p::Particle)::Tuple{Float64,Float64,Float64}</code></pre><p><code>_photon_emission</code> calculates the photon emission coordinates at a specified z depth in the radiator.     The emission point is determined by the particle&#39;s entry point and direction.     For x and y coordinates, the values are adjusted based on the particle&#39;s direction.     A single-argument method uses half the radiator depth as the emission point.</p><p><strong>Arguments</strong></p><ul><li><code>p::Particle</code>: The particle instance.</li><li><code>zemission::Float64</code>: Optional. Emission depth along the z-axis (mm).   If not provided, defaults to half the radiator depth.</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{Float64,Float64,Float64}</code>: A tuple containing (xpos, ypos, zpos) of the emission point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/rrabadan/TorchPID.jl/blob/5f20ea0e22a6826c96b767257621959b44c97e4a/src/Photon.jl#L350-L368">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hit_models/">« Hit Models</a><a class="docs-footer-nextpage" href="../photonmapper/">Photon Mapper »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Sunday 10 August 2025 18:02">Sunday 10 August 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
